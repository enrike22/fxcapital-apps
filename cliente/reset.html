<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FX | CAPITAL R.L. ‚Äî Restablecer contrase√±a</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0b0b0d; --card:#17191d; --outline:rgba(255,255,255,.08);
    --txt:#f5f7fb; --muted:#9aa1ac; --shadow:0 10px 30px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box} html,body{height:100%}
  body{
    margin:0; display:flex;align-items:center;justify-content:center;
    background:radial-gradient(1200px 800px at 10% -20%, #1a1d24 0%, #0b0b0d 55%) fixed;
    color:var(--txt); font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
  }
  .card{
    background:var(--card);border:1px solid var(--outline);border-radius:18px;
    padding:30px;max-width:420px;width:100%;box-shadow:var(--shadow)
  }
  h1{margin:0 0 12px;font-size:22px;font-weight:800;text-align:center}
  p{color:var(--muted);font-size:14px;text-align:center;margin-bottom:20px}
  .input{
    width:100%;background:#0f1116;border:1px solid var(--outline);border-radius:12px;
    color:var(--txt);padding:12px 14px;outline:none;margin-bottom:14px
  }
  .row{display:flex;align-items:center;gap:8px;margin-bottom:14px}
  .eye{cursor:pointer;user-select:none}
  .btn{appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:700;
    cursor:pointer;box-shadow:var(--shadow);width:100%}
  .btn.primary{background:#fff;color:#000}
</style>
</head>
<body>
  <div class="card">
    <h1>Restablecer Contrase√±a</h1>
    <p>Ingrese su nueva contrase√±a para continuar con el acceso.</p>

    <div class="row">
      <input id="newPassword" type="password" class="input" placeholder="Nueva contrase√±a">
      <div id="toggle1" class="eye">üëÅÔ∏è</div>
    </div>

    <div class="row">
      <input id="confirmPassword" type="password" class="input" placeholder="Confirmar contrase√±a">
      <div id="toggle2" class="eye">üëÅÔ∏è</div>
    </div>

    <button id="btnSave" class="btn primary">Guardar y continuar</button>
  </div>

  <script src="https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
  <script>
    const SUPABASE_URL = "https://czvpehbubfrinutztnwh.supabase.co";
    const SUPABASE_ANON_KEY = "TU_ANON_KEY_AQUI"; // üëà Reemplaza con tu Anon Key
    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Mostrar/ocultar contrase√±as
    function toggleEye(inputId, eyeId) {
      const input = document.getElementById(inputId);
      const eye = document.getElementById(eyeId);
      eye.onclick = () => { input.type = input.type === "password" ? "text" : "password"; };
    }
    toggleEye("newPassword", "toggle1");
    toggleEye("confirmPassword", "toggle2");

    document.getElementById("btnSave").onclick = async () => {
      const newPass = document.getElementById("newPassword").value.trim();
      const confirm = document.getElementById("confirmPassword").value.trim();

      if (!newPass || !confirm) { alert("Complete ambos campos."); return; }
      if (newPass !== confirm) { alert("Las contrase√±as no coinciden."); return; }

      const { data, error } = await sb.auth.updateUser({ password: newPass });
      if (error) {
        alert("Error: " + error.message);
      } else {
        alert("Contrase√±a actualizada con √©xito. Ahora puede iniciar sesi√≥n.");
        window.location.replace("/"); // üëà Te redirige al login
      }
    };
  </script>
</body>
</html>
